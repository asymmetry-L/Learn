# 1

## 操作系统的概念、功能和目标

### 概念

![操作系统层次结构](https://yanxuan.nosdn.127.net/510a97cf495e6ff485caa9586dae4217.png)

- 应用程序：如 QQ、微信
- 操作系统
  1. 负责管理协调硬件、软件等计算机资源的工作
  2. 为上层的应用程序、用户提供简单易用的服务、
  3. 操作系统是系统软件，而不是硬件
- 硬件：如 cpu、内存等

操作系统【Operating System，OS】：
指控制和管理整个计算机系统的硬件和软件资源，并合力贷组织调度计算机的工作和资源的分配，以提供给用户和其他软件方便的接口和环境，它是计算机系统中最基本的软件系统

### 功能和目标

#### 作为系统资源的管理者

功能

- 处理机管理
- 存储器管理
- 文件管理
- 设备管理

目标：安全高效

用 QQ 和朋友视频聊天的过程

    Step 1：在各个文件夹中找到QQ的安装位置
            # 逐层打开文件夹，找到可执行文件的存放位置
    Step 2：双击打开QQ.exe
            # 把改程序的相关数据放入内存
    Step 3：QQ开始运行
            # 对应的进程处理机（cpu）处理
    Step 4：开始和朋友视频聊天
            # 将摄像头设备分配给进程

#### 作为用户和计算机硬件之间的接口

功能

- 命令接口（允许用户<font color=red>直接使用</font>）
  - 联机命令接口：用户说一句，系统做一句，如 CMD，powershell
  - 脱机命令接口：用户说一堆，系统做一堆，如 bat 文件
- 程序接口（允许用户通过程序<font color=red>间接使用</font>）：由一组<font color=red>系统调用</font>组成
- GUI：现代操作系统中最流行的图形用户接口
  目标：方便用户使用

**系统调用 == 系统调用命令 == 广义指令**

#### 作为最接近硬件的层次

功能：对底层硬件的拓展

## 操作系统的特征

### 并发：两个或多个事件在同一间隔时间内发生。这些事件<font color=red>宏观上是同时发生</font>的，但<font color=red>微观上是交替发生</font>的。

    #并发
    - - - - - - - - -
     - - - - - - - - -

    #并行：同时存在多个运行着的程序
    -------------
    -------------

单核处理器同一时刻只能执行一个程序，四核处理器意味着同一时刻可以有四个程序并行执行，但并发性依然必不可少

### 共享：即资源共享，是指系统中的资源可供内存中多个并发执行的进程共同使用

#### 互斥共享方式

系统中的某些资源，虽然可以提供给多个进程使用，但一个时间段内只允许一个进程去访问该资源

#### 同时共享方式

系统中的某些资源，允许一个时间段内由多个进程“同时”对他们进行访问

### 虚拟：指把一个物体上的实体变为若干个逻辑上的对应物。物理实体实际存在的，而逻辑上对应物是用户感受到的

- 空分复用技术
- 时分复用技术：微观上处理机在各个微小的时间片上交替进行

### 异步：在多道程序环境下， 允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的，二十走走停停，以不可预知的速度向前推进

## 操作系统的发展和分类

### 手工操作阶段

主要缺点：用户独占全机、人机速度矛盾导致资源利用率极低

        用户 ——> 纸带机 ——> 处理机 ——> 纸带机 ——>用户

### 批处理阶段

- 单道批处理系统
  引入<font color=red>脱机输入/输出</font>（用磁带完成），并<font color=red>监督程序</font>负责控制作业的输入、输出

<font color=red>监督程序</font> ——> 操作系统雏形

        用户 ——> 纸带机 ——> 外围机 ——> [磁带] ——> 处理机 ——> [磁带] ——> 外围机 ——> 纸带机 ——>用户

主要优点：缓解了一点程度的人机速度矛盾，资源利用率有所提升

主要缺点：<font color=red>内存中仅能有一道程序运行</font>，只有该程序运行结束之后才能调入下一道程序。<font color=red>CPU 有大量时间实在空闲等待 I/O 完成</font>。资源利用率依然很低

- 多道批处理系统

        ……——> [磁带] =(每次往内存中输入多道程序)=> 处理机 ——> ……
        # 操作系统正式诞生

主要优点：多道程序<font color=red>并发</font>执行，<font color=red>共享</font>计算机资源。<font color=red>资源利用率大幅提升</font>，CPU 和其他资源保持“忙碌”状态，系统吞吐量增大。

主要缺点：用户响应时间长，<font color=red>没有人机交互功能</font>（用户提交自=自己的作业之后就只能等待计算机处理完成）

### 分时操作系统

计算机以<font color=red>时间片</font>为单位<font color=red>轮流为各个用户/作业服务</font>，各个用户可以通过终端与计算机进行交互。

主要优点：用户请求可以被及时响应，<font color=red>解决了人机交互问题</font>。允许多个用户同时使用一台计算机，并且用户对计算机的操作相互独立，感受不到别人的存在

主要缺点：<font color=red>不能优先处理一些紧急任务</font>。操作系统对各个用户/作业都是完全公平的，循环地为每个用户/作业服务提供一个时间片，部分任务的紧急性。

### 实时操作系统

主要优点：能够响应一些紧急任务，某些紧急任务不需时间片排队。在实时操作系统的控制下，计算机系统接受到外部信号后及时进行处理，并且<font color=red>要在严格的时限内处理完事件</font>

主要特点：<font color=red>及时性和可靠性</font>

实时操作系统

- 硬实时操作系统【必须在绝对严格的规定时间内完成处理】

- 软实时操作系统【能接受偶尔违反时间规定】

### 网络操作系统

### 分布式操作系统

### 个人计算机操作系统

## 操作系统的运行机制和体系结构

### 运行机制

#### 两种指令

- 特权指令【不允许普通用户使用】
- 非特权指令【】

#### 两种处理器状态

用程序状态字寄存器（PSW）中的某标志位来标识当前处理器出于什么状态。如 0 为用户态，1 为核心态

- 用户态（目态）
  此时 CPU 只能执行非特权指令
- 核心态（管态）
  特权指令、非特权指令都可以执行

#### 两种程序

- 内核程序

        操作系统的内核程序是系统的管理者，既可以执行特权指令，也可以执行非特权指令，运行在核心态

- 应用程序

        为了保证系统能安全运行，普通应用程序只能执行非特权指令，运行在用户态

### 操作系统内核

<font color=red>内核</font>是计算机上配置的底层<font color=red>软件</font>，是操作系统最基本，最核心的部分。

- 时钟管理
  实现计时功能
- 中断处理
  负责实现中断机制
- 原语
  原语是一种特殊的程序。是最接近硬件的部分，这种程序的运行具有原子性（要么不执行，要么别停）
- 对系统资源进行管理的功能
  - 进程管理
  - 存储器管理
  - 设备管理

### 操作系统的体系结构

#### 大内核

将操作系统的主要功能模块都作为系统内核，运行在核心态

- 优点：高性能
- 缺点：内核代码庞大，结构混乱，难以维护

#### 微内核

只把最基本的功能保留在内核

- 优点：内核功能少，结构清晰，方便维护
- 缺点：需要频繁的在核心态和用户态切换，性能低

## 中断和异常

### 中断机制的诞生
本质：<font color=red>发生中断</font>就意味着<font color=red>操作系统介入，开展管理工作</font>
### 中断的概念和作用
1. 当中断发生时，CPU立即进入<font color=red>核心态</font>
2. 当中断发生后，当前运行的进程暂停运行，并由操作系统对中断进行处理
3. 对于不同的中断信号，会进行不同的处理
### 中断的分类

### 外中断的处理

## 系统调用
